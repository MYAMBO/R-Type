<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spritesheet Selector - R-Type Boss</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #00ff00;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #00ff00;
            text-shadow: 0 0 10px #00ff00;
            font-size: 2.5em;
        }
        
        .instructions {
            background: rgba(0, 255, 0, 0.1);
            border: 2px solid #00ff00;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 10px;
        }
        
        .instructions h2 {
            margin-bottom: 15px;
            color: #00ffff;
        }
        
        .instructions ul {
            margin-left: 20px;
            line-height: 1.8;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 30px;
        }
        
        .canvas-container {
            background: rgba(0, 0, 0, 0.5);
            border: 3px solid #00ff00;
            border-radius: 10px;
            padding: 20px;
            overflow: auto;
            max-height: 800px;
        }
        
        canvas {
            display: block;
            cursor: crosshair;
            image-rendering: pixelated;
            image-rendering: crisp-edges;
        }
        
        .controls {
            background: rgba(0, 255, 0, 0.1);
            border: 2px solid #00ff00;
            padding: 20px;
            border-radius: 10px;
            height: fit-content;
        }
        
        .control-group {
            margin-bottom: 20px;
        }
        
        .control-group label {
            display: block;
            margin-bottom: 8px;
            color: #00ffff;
            font-weight: bold;
        }
        
        .control-group input[type="file"] {
            width: 100%;
            padding: 10px;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid #00ff00;
            color: #00ff00;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .control-group input[type="number"] {
            width: 100%;
            padding: 10px;
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid #00ff00;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            border-radius: 5px;
        }
        
        .grid-controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .output {
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #00ffff;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        
        .output h3 {
            color: #00ffff;
            margin-bottom: 10px;
        }
        
        .code-block {
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid #00ff00;
            padding: 15px;
            border-radius: 5px;
            font-size: 13px;
            line-height: 1.6;
            overflow-x: auto;
            color: #00ff00;
            white-space: pre;
        }
        
        button {
            width: 100%;
            padding: 12px;
            background: rgba(0, 255, 0, 0.2);
            border: 2px solid #00ff00;
            color: #00ff00;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            border-radius: 5px;
            transition: all 0.3s;
            margin-top: 10px;
        }
        
        button:hover {
            background: rgba(0, 255, 0, 0.4);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.5);
        }
        
        .selection-info {
            background: rgba(0, 255, 255, 0.1);
            border: 2px solid #00ffff;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        
        .selection-info h3 {
            color: #00ffff;
            margin-bottom: 10px;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            font-size: 14px;
        }
        
        .info-item {
            background: rgba(0, 0, 0, 0.5);
            padding: 8px;
            border-radius: 3px;
            border: 1px solid #00ff00;
        }
        
        .info-label {
            color: #00ffff;
            font-weight: bold;
        }
        
        .info-value {
            color: #00ff00;
            float: right;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéÆ R-TYPE SPRITESHEET SELECTOR üéÆ</h1>
        
        <div class="instructions">
            <h2>üìã Instructions</h2>
            <ul>
                <li><strong>1.</strong> Charge ta spritesheet (r-typesheet41.gif)</li>
                <li><strong>2.</strong> Clique et drag pour s√©lectionner UNE frame du boss</li>
                <li><strong>3.</strong> Entre le nombre de frames et colonnes</li>
                <li><strong>4.</strong> Copie le code C++ g√©n√©r√© !</li>
            </ul>
        </div>
        
        <div class="main-content">
            <div class="canvas-container">
                <canvas id="canvas"></canvas>
            </div>
            
            <div class="controls">
                <div class="control-group">
                    <label>üìÅ Load Spritesheet:</label>
                    <input type="file" id="fileInput" accept="image/*">
                </div>
                
                <div class="selection-info">
                    <h3>üìê Selection Info</h3>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Start X:</span>
                            <span class="info-value" id="startX">0</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Start Y:</span>
                            <span class="info-value" id="startY">0</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Width:</span>
                            <span class="info-value" id="width">0</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Height:</span>
                            <span class="info-value" id="height">0</span>
                        </div>
                    </div>
                </div>
                
                <div class="control-group">
                    <label>üéûÔ∏è Number of Frames:</label>
                    <input type="number" id="nbFrames" value="5" min="1">
                </div>
                
                <div class="control-group">
                    <label>üìä Frames per Row:</label>
                    <input type="number" id="framesPerRow" value="5" min="1">
                </div>
                
                <div class="grid-controls">
                    <div class="control-group">
                        <label>‚ÜîÔ∏è Offset X:</label>
                        <input type="number" id="offsetX" value="0" min="0">
                    </div>
                    <div class="control-group">
                        <label>‚ÜïÔ∏è Offset Y:</label>
                        <input type="number" id="offsetY" value="0" min="0">
                    </div>
                </div>
                
                <button onclick="generateCode()">‚ö° Generate C++ Code</button>
                
                <div class="output">
                    <h3>üíª C++ Code (Animator):</h3>
                    <div class="code-block" id="codeOutput">// Select a region first...</div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        let image = null;
        let isSelecting = false;
        let startPos = { x: 0, y: 0 };
        let endPos = { x: 0, y: 0 };
        let selection = { x: 0, y: 0, w: 0, h: 0 };
        
        // Load image
        document.getElementById('fileInput').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    image = new Image();
                    image.onload = () => {
                        canvas.width = image.width;
                        canvas.height = image.height;
                        drawImage();
                    };
                    image.src = event.target.result;
                };
                reader.readAsDataURL(file);
            }
        });
        
        // Mouse events
        canvas.addEventListener('mousedown', (e) => {
            const rect = canvas.getBoundingClientRect();
            startPos.x = Math.floor((e.clientX - rect.left) * (canvas.width / rect.width));
            startPos.y = Math.floor((e.clientY - rect.top) * (canvas.height / rect.height));
            isSelecting = true;
        });
        
        canvas.addEventListener('mousemove', (e) => {
            if (!isSelecting) return;
            const rect = canvas.getBoundingClientRect();
            endPos.x = Math.floor((e.clientX - rect.left) * (canvas.width / rect.width));
            endPos.y = Math.floor((e.clientY - rect.top) * (canvas.height / rect.height));
            drawImage();
        });
        
        canvas.addEventListener('mouseup', (e) => {
            isSelecting = false;
            const rect = canvas.getBoundingClientRect();
            endPos.x = Math.floor((e.clientX - rect.left) * (canvas.width / rect.width));
            endPos.y = Math.floor((e.clientY - rect.top) * (canvas.height / rect.height));
            
            selection.x = Math.min(startPos.x, endPos.x);
            selection.y = Math.min(startPos.y, endPos.y);
            selection.w = Math.abs(endPos.x - startPos.x);
            selection.h = Math.abs(endPos.y - startPos.y);
            
            updateInfo();
            drawImage();
        });
        
        function drawImage() {
            if (!image) return;
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(image, 0, 0);
            
            // Draw selection
            if (isSelecting || (selection.w > 0 && selection.h > 0)) {
                ctx.strokeStyle = '#00ff00';
                ctx.lineWidth = 2;
                ctx.setLineDash([5, 5]);
                
                const x = isSelecting ? Math.min(startPos.x, endPos.x) : selection.x;
                const y = isSelecting ? Math.min(startPos.y, endPos.y) : selection.y;
                const w = isSelecting ? Math.abs(endPos.x - startPos.x) : selection.w;
                const h = isSelecting ? Math.abs(endPos.y - startPos.y) : selection.h;
                
                ctx.strokeRect(x, y, w, h);
                ctx.fillStyle = 'rgba(0, 255, 0, 0.1)';
                ctx.fillRect(x, y, w, h);
                
                // Draw grid
                const nbFrames = parseInt(document.getElementById('nbFrames').value);
                const framesPerRow = parseInt(document.getElementById('framesPerRow').value);
                const offsetX = parseInt(document.getElementById('offsetX').value);
                const offsetY = parseInt(document.getElementById('offsetY').value);
                
                ctx.strokeStyle = '#00ffff';
                ctx.lineWidth = 1;
                ctx.setLineDash([2, 2]);
                
                for (let i = 0; i < nbFrames; i++) {
                    const col = i % framesPerRow;
                    const row = Math.floor(i / framesPerRow);
                    const frameX = x + col * (w + offsetX);
                    const frameY = y + row * (h + offsetY);
                    ctx.strokeRect(frameX, frameY, w, h);
                }
            }
        }
        
        function updateInfo() {
            document.getElementById('startX').textContent = selection.x;
            document.getElementById('startY').textContent = selection.y;
            document.getElementById('width').textContent = selection.w;
            document.getElementById('height').textContent = selection.h;
        }
        
        function generateCode() {
            const nbFrames = document.getElementById('nbFrames').value;
            const framesPerRow = document.getElementById('framesPerRow').value;
            const offsetX = document.getElementById('offsetX').value;
            const offsetY = document.getElementById('offsetY').value;
            
            const code = `// Animator Configuration
boss->addComponent<Animator>(
    ${nbFrames},      // Number of frames
    ${framesPerRow},      // Frames per row
    0.15f,    // Frame rate (seconds)
    ${selection.x},       // startX
    ${selection.y},       // startY
    ${selection.w},       // frameWidth
    ${selection.h},       // frameHeight
    ${offsetX},       // offsetX
    ${offsetY}        // offsetY
);`;
            
            document.getElementById('codeOutput').textContent = code;
        }
        
        // Update on input change
        ['nbFrames', 'framesPerRow', 'offsetX', 'offsetY'].forEach(id => {
            document.getElementById(id).addEventListener('input', () => {
                drawImage();
                if (selection.w > 0) generateCode();
            });
        });
    </script>
</body>
</html>
